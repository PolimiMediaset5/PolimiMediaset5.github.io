<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Walking the Tightrope - VIDO</title>

    <link rel="stylesheet" type="text/css" href="viewingPage.css">
    <script src="srcs/jquery-3.5.1.min.js"></script>
</head>

<body>
    <div id="popup_360">
        <div id="text_popup_360">Entering 360 segments.<br>
            Please use your mouse to interact.
        </div>
    </div>

    <div id="video-wrapper-1">
        <video requestFullScreen controls autoplay frameborder="0" height="100%" width="100%" id="video_1">
            <source src="vids/1.mp4" type="video/mp4">
        </video>
    </div>

    <iframe src="https://hyper360.api.eng.it/H360/use?processId=Pablo&resourceName=G5_2_360&controls=true&postmsg=false&autoplay=true&group=RTI_HYPER360ASSESS&compassStatus=false" frameborder="0" height="100%" width="100%" id="360_video"></iframe>

    <div id="video-wrapper-3">
        <video requestFullScreen controls autoplay frameborder="0" height="100%" width="100%" id="video_3">
            <source src="vids/3.mp4" type="video/mp4">
        </video>
    </div>

    <script>
        var v1 = document.getElementById('video_1');
        var v1_wrapper = document.getElementById('video-wrapper-1');
        var v2 = document.getElementById('360_video');
        var v3 = document.getElementById('video_3');
        var v3_wrapper = document.getElementById('video-wrapper-3');

        var load_times = 0;

        v2.style.display = "none";
        v2.muted = true;
        v3_wrapper.style.display = "none";
        v3.muted = true;
        v1.muted = false;
        v1.addEventListener('ended', myHandler, false);

        function myHandler(e) {
            v1_wrapper.style.display = "none";
            v1.muted = true;
            $("#popup_360").fadeIn(1000).delay(3000).fadeOut(1000);
            v2.style.display = "flex";
            v2.muted = false;
        }


        v2.onload = function() {
            load_times = load_times + 1;
            if (load_times == 2) {
                v2.src = "http://www.google.com";
                v2.style.display = "none";
                v2.muted = true;
                v1_wrapper.style.display = "none";
                console.log("mute v1");
                v1.muted = true;
                console.log(v1.muted);
                v3.muted = false;
                v3_wrapper.style.display = "block";
            }

        };

        if (v3_wrapper.style.display == "block") {
            v1.muted = true;
            v1_wrapper.style.display = "none";
        }

        v3.addEventListener('ended', goToDetailPage, false);

        function goToDetailPage(e) {
            window.location.href = "videoDetail.html";
        }

    </script>

</body>

</html>
